<screen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="http://moqui.org/xsd/xml-screen-3.xsd"
        default-menu-title="Dashboard" default-menu-index="1">

    <actions>
        <set field="facilityId" from="facilityId ?: ec.user.getPreference('FacilityActive') ?: ec.user.getPreference('FacilityGeneralDefault')"/>
        <set field="pageSize" from="pageSize ?: 60"/>
        <set field="result" from="ec.service.sync().name('UIServices.searchProduct').parameters(ec.context).call()"/>
        <set field="productList" from="result.productList"/>
        <set field="tileName" from="result.tileName"/>
        <script>paginateList("productList", null, context)</script>
    </actions>

    <widgets>
        <container-row><row-col md="6">
            <form-single name="SearchForm" transition="." focus-field="lookupId">
                <field name="lookupId"><default-field title="Cod bare"><text-line/></default-field></field>
                <field name="submitButton"><default-field title="Cauta"><submit/></default-field></field>
                <field-layout><field-row-big><field-ref name="lookupId"/><field-ref name="submitButton"/></field-row-big></field-layout>
            </form-single>
        </row-col>
        <row-col md="6">
            <form-single name="TileForm">
                <field name="tileName"><default-field title="Model gresie"><text-line/></default-field></field>
                <field name="scrapeDunca"><default-field title="Cauta Dunca"><submit/></default-field></field>
                <field-layout><field-row-big><field-ref name="tileName"/><field-ref name="scrapeDunca"/></field-row-big></field-layout>
            </form-single>
        </row-col></container-row>

        <form-list name="ProductList" list="productList" skip-form="true">
            <row-actions>
                <entity-find entity-name="mantle.product.ProductIdentification" list="prodIdentList">
                    <econdition field-name="productId"/><order-by field-name="productIdTypeEnumId"/></entity-find>
            </row-actions>
            <field name="pseudoId">
                <header-field title="ID" show-order-by="case-insensitive"/>
                <default-field><display also-hidden="false"/></default-field>
            </field>
            <field name="prodIdents"><default-field title="Other IDs">
                <section-iterate name="OtherProductIdSection" list="prodIdentList" entry="prodIdent"><widgets>
                    <label text="${prodIdent.idValue} (${prodIdent.type?.description ?: ''})" type="div"/>
                </widgets></section-iterate>
            </default-field></field>

            <field name="productName">
                <header-field title="Name" show-order-by="case-insensitive"/>
                <default-field><display also-hidden="false"/></default-field>
            </field>

            <field name="priceNicename">
                <header-field title="Price" show-order-by="true"/>
                <default-field><display also-hidden="false"/></default-field>
            </field>

            <field name="stockL1">
                <header-field title="Stoc L1" show-order-by="true"/>
                <default-field><display also-hidden="false"/></default-field>
            </field>
            <field name="stockL2">
                <header-field title="Stoc L2" show-order-by="true"/>
                <default-field><display also-hidden="false"/></default-field>
            </field>

            <form-list-column><field-ref name="pseudoId"/><field-ref name="prodIdents"/></form-list-column>
            <form-list-column><field-ref name="productName"/></form-list-column>
            <form-list-column><field-ref name="priceNicename"/></form-list-column>
            <form-list-column><field-ref name="stockL1"/></form-list-column>
            <form-list-column><field-ref name="stockL2"/></form-list-column>
        </form-list>
    </widgets>

</screen>